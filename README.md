This is a project that takes an otamatone (https://otamatone.com/) and hijacks the control using digital potentiometers and a Teensy running USB MIDI libraries to turn it into a MIDI instrument.

The Controller PCB files currently use optoisolators. This design does not work correctly. I manually replaced the optoisolators with darlington NPN transistors, and that led to everything functioning as intended. I plan to revisit the PCB ocne I've tested the advanced features of the board (such as the servo control for opening the mouths, and the addressable LED lighting for the heads) to avoid needing more revisions.

The otamatone has had the touch-pot 'neck' removed and replaced with a connection to two MCP4151 digital potentiometers. I also had to connect two wires to the speaker outputs to get feedback on the frequency being played as the circuit is unstable over time and I could not map a resistance value to a given note accurately and reliably. I ended up removing the original PCBs from the heads and locating them centrally on my controller PCB to make wiring the heads and replacing damaged controllers easier. 

The current revision of the code is working with basic MIDI functionality, including note on, note off, and pitch bend. The pitch bending currently applies to every note currently being played. I intend to change it so that the pitch bend will apply to all the notes only on the MIDI channel it was sent on. This will allow multi-track MIDI files to send each track on a different channel so pitch bend will not effect all the tracks simultaneously. As far as I am aware, there is no way to differentiate tracks once the note messages are sent over MIDI if they are all sending to the same MIDI device, so per-track pitch bend is the best I can hope for given my single MIDI controller setup.

My goal is to finish the design and get all my planned features working with the current PCB, and then release a final version of the code and PCB for anyone who wants to follow in my crazy footsteps.